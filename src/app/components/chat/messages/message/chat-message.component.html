<div class="message" [class.own]="isOwnMessage">
  <ng-container *ngFor="let part of messageGroup">
    
    <!-- ðŸ“ Testo -->
    <div *ngIf="part.type === 'text'" class="text">
      {{ part.content }}
      <div class="timestamp">{{ formatTime(part.createdAt) }}</div>
    </div>

    <!-- ðŸ–¼ï¸ Immagine giÃ  caricata -->
    <img *ngIf="part.type === 'file' && isImage(part.fileName) && part.localUrl"
         [src]="part.localUrl"
         [alt]="part.fileName"
         class="image"
         (click)="openImagePreview(part.localUrl!, part.fileName!)" />

    <!-- â³ Placeholder immagine mentre si carica -->
    <div *ngIf="part.type === 'file' && isImage(part.fileName) && !part.localUrl"
         class="image-loading">
         {{ part.fileName }}
    </div>

    <!-- ðŸ“Ž File non immagine -->
    <div *ngIf="part.type === 'file' && !isImage(part.fileName)"
         class="file"
         (click)="fileClick.emit({ url: part.fileUrl!, name: part.fileName! })">
      ðŸ“Ž {{ part.fileName }}
    </div>

  </ng-container>
</div>
